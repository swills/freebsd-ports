before_script:
  - PORT_LIST=$(mktemp) ; git diff --no-prefix --name-only 46dec1162fa6...origin/MFH/r475280/2018Q3 | egrep '('$(env PORTSDIR=${CI_PROJECT_DIR} make -V SUBDIR | sed -e 's/ /|/g')')' | cut -d/ -f 1,2 | sort -u | sed -e 's/$/@all/' > ${PORT_LIST}

head-amd64:
  stage: build
  script:
  - sudo nice -n 18 /usr/sbin/idprio 29 poudriere bulk -C -t -B ${CI_PIPELINE_ID} -j head-amd64 -p swills-freebsd-ports -f ${PORT_LIST}

head-i386:
  stage: build
  script:
  - sudo nice -n 18 /usr/sbin/idprio 29 poudriere bulk -C -t -B ${CI_PIPELINE_ID} -j head-i386 -p swills-freebsd-ports -f ${PORT_LIST}

111-amd64:
  stage: build
  script:
  - sudo nice -n 18 /usr/sbin/idprio 29 poudriere bulk -C -t -B ${CI_PIPELINE_ID} -j 111-amd64 -p swills-freebsd-ports -f ${PORT_LIST}

111-i386:
  stage: build
  script:
  - sudo nice -n 18 /usr/sbin/idprio 29 poudriere bulk -C -t -B ${CI_PIPELINE_ID} -j 111-i386 -p swills-freebsd-ports -f ${PORT_LIST}

104-amd64:
  stage: build
  script:
  - sudo nice -n 18 /usr/sbin/idprio 29 poudriere bulk -C -t -B ${CI_PIPELINE_ID} -j 104-amd64 -p swills-freebsd-ports -f ${PORT_LIST}

104-i386:
  stage: build
  script:
  - sudo nice -n 18 /usr/sbin/idprio 29 poudriere bulk -C -t -B ${CI_PIPELINE_ID} -j 104-i386 -p swills-freebsd-ports -f ${PORT_LIST}
